---
title       : The building blocks
description : Asset returns and portfolio weights; those are the building blocks of a portfolio return. In this chapter, you will learn the definition of a portfolio return and how to compute it in R. The exercises involve both simple two-asset cases and a real-life portfolio invested in the 30 Dow Jones Industrial Average stocks. The final exercises consist in linking portfolio returns to the nominal portfolio value and doing a multi-period analysis.   

--- type:VideoExercise lang:r xp:50 skills:1
## The power of portfolio diversification

*** =video_link
//player.vimeo.com/video/108225030

--- type:NormalExercise lang:r xp:100 skills:1
## Calculating portfolio weights when component values are given

An investor has  4000 USD invested in equities, 4000 USD in bonds and 2000 USD in commodities. In order to compute the corresponding portfolio weights, define the vector `values` as the vector holding these three values. Then define the vector `weights` as the vector `values` divided by the total value (obtained by summing over the component values using the function `sum`).

*** =instructions
- Define the vector `values`.
- Define the vector `weights`.
- Print the vector `weights`.

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# Define the vector values

# Define the vector weights

# Print the resulting weights
```

*** =solution
```{r}
# Define the vector values
values <- c(4000,2000,2000)
# Define the vector weights
weights <- values/sum(values)
# Print the resulting weights
print(weights)
```

*** =sct
```{r}
# sct code
```

--- type:MultipleChoiceExercise lang:r xp:50 skills:1
## Defining the portfolio weights for an equally weighted portfolio

The equally weighted portfolio is one of the most used portfolios. Suppose the portfolio is equally invested in $N$ assets. Let `N <- 100`. Which of the following commands does not define properly the portfolio weights for this vector. Which of the following commands I give several commands to define the portfolio weights of an equally weighted portfolio of N=100 assets. E.g. N=100; ComponentWeights = rep(1,N)/N. N=100; ComponentWeights = rep(1/N,N).   N=100; ComponentWeights = 1/N.  Which is one is wrong?

*** =instructions
- `weights <- rep(1,N)/N`
- `weights <- 1/N`
- `weights <- rep(1/N,N)`

*** =hint
The function `rep(arg1,arg2)` creates a vector in which `arg1` is replicated `arg2` times. 

*** =pre_exercise_code
```{r}
# pec
```

*** =sct
```{r}
test_mc(2) # if 2 is the correct option.
```

--- type:NormalExercise lang:r xp:100 skills:1
## Calculating characteristic-based portfolio weights

In a characteristic-based portfolio, the weight is given by the asset's characteristic value divided by the sum of the characteristic values of all assets. A typical example is the market capitalization weighted portfolio. Define the vector `characteristics` as the sequence from 1 to 100 and compute the corresponding portfolio weights. Inspect the distribution of the portfolio weights using the function `summary()`.

*** =instructions
- Define `characteristics`
- Define `weights`
- Print `summary(weights)`

*** =hint
`seq(arg1,arg2)` yields a vector holding elements `arg1, arg1+1, arg1+2,...,arg2`.

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# Define characteristics

# Compute the weights

# Inspect summary statistics

```

*** =solution
```{r}
# Define characteristics
characteristics <- seq(1,100)
# Compute the weights
weights <- characteristics/sum(characteristics)
# Inspect summary statistics
print(summary(weights))
```

*** =sct
```{r}
# sct code
```


--- type:VideoExercise lang:r xp:50 skills:1
## Portfolio returns are the weighted average of the individual returns


*** =video_link
//player.vimeo.com/video/108225030

--- type:NormalExercise lang:r xp:100 skills:1
## Calculation of portfolio returns

The initial vector of component values is 'in.values=c(1000,5000,2000)'. Suppose that the value changes to 'fin.values=c(1100,4500,3000)'. Define 'in.weights = in.values/sum(in.values)' as the weights at the start of the investment horizon.  Define 'returns = (fin.values-in.values)/in.values' as the returns of the three components. Verify that the weighted average portfolio return ( 'sum(in.weights*returns)'  ) equals the percentage change in the total portfolio value (sum(fin.values)-sum(in.values))/sum(in.values).

*** =instructions
- instruction 1
- instruction 2

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# sample code
```

*** =solution
```{r}
# solution code
```

*** =sct
```{r}
# sct code
```

--- type:NormalExercise lang:r xp:100 skills:1
## Calculation of portfolio returns

An alternative definition of return used in finance is log-returns. Let us now verify that log-returns do not have the portfolio aggregation property.  Define 'logreturns = log(fin.values)-log(in.values)' as the returns of the three components. Verify that the weighted average portfolio return ( 'sum(in.weights*logreturns)'  ) does not equal the log-return computed on the total portfolio value (log(sum(fin.values))-log(sum(in.values))).

*** =instructions
- instruction 1
- instruction 2

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# sample code
```

*** =solution
```{r}
# solution code
```

*** =sct
```{r}
# sct code
```

--- type:MultipleChoiceExercise lang:r xp:50 skills:1
## Defining the portfolio returns for an equally weighted portfolio

I give several commands to define the portfolio returns of an equally weighted portfolio of N=100 assets with return vector y. EWreturns = mean(y); EWreturns = sum( rep(1/N,N)*y ) ; EWreturns = sum( y )/N ;  EWreturns= rep(mean(y),N).  Which one is wrong?

*** =instructions
- option 1
- option 2
- option 3

*** =hint
hint

*** =pre_exercise_code
```{r}
# pec
```

*** =sct
```{r}
test_mc(2) # if 2 is the correct option.
```

--- type:VideoExercise lang:r xp:50 skills:1
## A time series of portfolio returns

Let us now consider a practical case of the 30 Dow Jones Industrial Average (DJIA) Constituents over the period xxxx. The corresponding monthly price data is available as a zoo (?) time series object. The corresponding multivariate return series can be easily computed using the function calculateReturns in PerformanceAnalytics. The first observation is NA, because there is no previous price available. We can remove the first row in returns using [(-1),].
*** =video_link
//player.vimeo.com/video/108225030

--- type:NormalExercise lang:r xp:100 skills:1
## From prices to returns and the equally weighted portfolio return

Convert the DJIA price data into a return data. Use head( ) and tail( ) to print the first 6 and last 6 rows. Use table.CalandarReturns in PerformanceAnalytics to present as month x year.

*** =instructions
- instruction 1
- instruction 2

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
library(xts)
# load djia data
```

*** =sample_code
```{r}
# sample code
```

*** =solution
```{r}
# solution code
```

*** =sct
```{r}
# sct code
```

--- type:NormalExercise lang:r xp:100 skills:1
## The equally weighted portfolio return

The equally  weighted portfolio has the return equal to the average. use rowMeans( ) to compute it and make a  time series plot.

*** =instructions
- instruction 1
- instruction 2

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# sample code
```

*** =solution
```{r}
# solution code
```

*** =sct
```{r}
# sct code
```

--- type:MultipleChoiceExercise lang:r xp:50 skills:1
## The asymmetric impact of gains and losses.

Assume an investor with portfolio value 100 has a loss of 50%. What is the return needed to be at par again? 50%, 100%, 200%.

*** =instructions
- option 1
- option 2
- option 3

*** =hint
hint

*** =pre_exercise_code
```{r}
# pec
```

*** =sct
```{r}
test_mc(2) # if 2 is the correct option.
```

--- type:MultipleChoiceExercise lang:r xp:50 skills:1
## The asymmetric impact of gains and losses.

Assume an investor with portfolio value 100 has a gain of 50%. Hom much can he lose to be at par again? 33.33%, 50%, 100%.

*** =instructions
- option 1
- option 2
- option 3

*** =hint
hint

*** =pre_exercise_code
```{r}
# pec
```

*** =sct
```{r}
test_mc(2) # if 2 is the correct option.
```

--- type:NormalExercise lang:r xp:100 skills:1
## Portfolio value

Portfolio value as compounded gross returns. The function cumprod.

*** =instructions
- instruction 1
- instruction 2

*** =hint
hint comes here

*** =pre_exercise_code
```{r}
# pec
```

*** =sample_code
```{r}
# sample code
```

*** =solution
```{r}
# solution code
```

*** =sct
```{r}
# sct code
```

